**Теорема 4**

$\displaystyle \overline{C}_n^k = C_{n+k-1}^k$

$\square$

Хотим установить взаимнооднозначное соответствие между $k$-сочетаниями с повторениями из $n$ объектов и $k$ сочетаниями без повторений из $n+k-1$ объектов.

Пример сопоставления

$n=33$, $\{а,б,\ldots,ё,\ldots,я\}$

$k=4$, $\{ж,а,б,а\}$, $\{а,а,б,ж\}$ - два примера сочетания с повторениями.

Идем последовательно по алфавиту и смотрим сколько раз буква встречается в сочетании. 

Первая буква $а$. Встречается два раза $\Rightarrow$ записываем $11$ (две единички).
Затем ставим $0$-перегородку.

Идем далее. Буква $б$ встречается один раз. Записываем $1$ и ставим перегородку.

Далее нет букв до $ж$. Вместо них ставим просто перегородки.

$ж$ встречается один раз. Ставим $1$ и перегородку.

В итоге включая $ж$ получаем $110100000010$.

Так продолжаем до последней буквы, но после $я$ перегородку не ставим.

В итоге получаем в данной двоичной последовательности четыре единицы ($k=4$) и 32 нуля. Таким образом у нас в двоичной последовательности $36$ чисел, $36 = 33 + 4 - 1 = n + k -1$.

Так можно сделать с любым сочетанием. Общая схема полученной двоичной последовательности имеет вид
$$
а0б0в0\ldots 0ё0\ldots 0ю0я
$$

Такая двоичная последовательность однозначно восстанавливается в сочетание.

В общем случае имеем множество $a_1, \ldots, a_n$.

Возьмем любое сочетание с повторением и будем действовать аналогично. Смотрим, сколько раз встречается $a_1$. Столько единиц записываем, а затем - перегородку и так до конца.
Получаем двоичныюю последовательность такого вида
$$
a_10a_20a_30\ldots 0a_{n-1}0a_n
$$

Единиц всегда будет $k$ штук, а нулей - $n-1$. Всего цифр будет $n+k-1$.

Поскольку между $k$ сочетаниями с повторением из $n$ и всеми последовательностями длины $n+k-1$, состоящими из $k$ единиц и $n$ нулей - взаимнооднозначное, то получам, что количество таких последовательностей = $C_n^k$.

Сколько есть последовательностей, где $k$ единиц и $n-1$ - нулей?

Когда мы рисуем любую двоичную последовательность из $k$ единиц и $n-1$ нулей, то по факту мы выбираем из $n+k-1$ позиций множество из $k$ позиций, на которых стоят единицы. Как только мы выбрали это множество $\Rightarrow$ получили последовательность.

Сколькими способами можно выбрать эти $k$ позиций из $n+k-1$ позиций? $C_{n-k+1}^k$

$\blacksquare$

## Бином Ньютона

$(x+y)^1 = x + y$

$(x+y)^2 = x^2 + 2xy + y^2$

$(x+y)^3 = x^3 + 3x^2y + 2xy^2 + y^3$

$(x+y)^4 = x^4 + 4x^3y + 6x^2y^2 + 4xy^3 + y^4$

$\ldots$

$(x+y)^{1000} = \ldots + C_{1000}^{432} x^{432} y^{568}+ \ldots$

**Теорема**

$$
(x+y)^n = \sum\limits_{k=0}^n C_n^k x^k y^{n-k}
$$

$$
(x+y)^n = (x+y)\cdot (x+y) \times \cdots \times (x+y)
$$

$k$ - число скобок, из которых взяли $x$, $0 \le k \le n$

$n-k$ - число скобок, из которых взяли $y$

При перемножении будет $x^k y^{n-k}$. Но мы могли по разномы выбрать  $k$ скобок. Количество этих выборов - $C_n^k$

Приводя подобные слагаемые получаем, что для каждого $k$ их имеется $C_n^k x^k y^{n-k}$.

$\blacksquare$

## Комбинаторные тождества

1.

$C_n^k = C_n^{n-k}$

$$
C_n^{n-k} = \frac{n!}{(n-k)!(n-n+k)!} = \frac{n!}{k!(n-k)!} = C_n^k!
$$

Другое доказательство.

$\{0,1,2,3,4,5,6,7,8,9\}$

$k=4$ - сочетание $\{0,1,5,6\} \Leftrightarrow \{2,3,4,7,8,9\}$, т.е. $k$ сочетанию однозначно ставится в соответствие $n-k$ сочетание и $\Rightarrow$ количество этих сочетаний одинакого

2.

$C_n^k = C_{n-1}^k + C_{n-1}^{k-1}$

Треугольник Паскаля

$$
\begin{matrix}
&&&&& 1 &&\\
&&&& 1 && 1\\
&&& 1 && 2 && 1\\
&& 1 && 3 && 3 && 1\\
& 1 && 4 && 6 && 4 && 1\\
1 && 5 && 10 && 10 && 5 && 1
\end{matrix}
$$

$$
(x+y)^0 = 1 \\
\ \\
(x+y)^2 = 1x + 1y \\
\ \\
(x+y)^2 = 1x^2 + 2xy + 1y^2 \\
\ \\ 
(x+y)^3 = 1x^3 + 3x^2y + 2xy^2 + 1y^3\\
\ \\
(x+y)^4 = 1x^4 + 4x^3y + 6x^2y^2 + 4xy^3 + 1y^4
\ \\
\ldots
$$

Биномиальные коэффициенты

$$
\begin{matrix}
&&&&& C_0^0 &&\\
&&&& C_1^0 && C_1^1\\
&&& C_2^0 && C_2^1 && C_2^2\\
&& C_3^0 && C_3^1 && C_3^2 && C_3^3\\
& C_4^0 && C_4^1 && C_4^2 && C_4^3 && C_4^4\\
C_5^0 && C_5^1 && C_5^2 && C_5^3 && C_5^4 && C_5^5
\end{matrix}
$$

$\square$

$$
C_{n-1}^k + C_{n-1}^{k-1} = \frac{(n-1)!}{k!(n-1-k)!} + \frac{(n-1)!}{(k-1)!(n-1-k+1)!} = \\
\ \\
= (n-1)! \cdot \Bigg(\frac{1}{k!(n-k-1)!} + \frac{1}{(k-1)!(n-k)!} \Bigg) = \\
\ \\
= (n-1)! \cdot \Bigg(\frac{n-k}{k!(n-k)!} + \frac{k}{k!(n-k)!} \Bigg) = \\
\ \\
= (n-1)! \cdot \Bigg(\frac{n-k + k}{k!(n-k)!} \Bigg) = \frac{(n-1)! \cdot n}{k!(n-k!)} = \frac{n!}{k!(n-k)!} = C_n^k\\
$$

Другое доказательство.

Любое $k$ сочетание из $n$ объектов либо содержит $a_1$, либо НЕ содержит $a_1$.

Сколько всего $k$ сочетаний? Сумма тех, что содержит $a_1$ и тех, что не содержит $a_1$.

Число $k$ сочетаний, которые не содержат $a_1$ - $C_{n-1}^{k}$. По $k$, так как $a_1$ нет, а следовательно, из оставшихся $n-1$ элементов нужно выбрать $k$.

Число $k$ сочетаний, которые содержат $a_1$ - $C_{n-1}^{k-1}$. По $k - 1$, так как $a_1$ есть, а следовательно, из оставшихся $n-1$ элементов нужно выбрать $k - 1$, так как одну уже есть.

3.

$C_n^0 + C_n^1 + C_n^2 + \cdots + C_n^n = 2^n$

Если сложить в треугольнике Паскаля все числа в ряду, то получим стерени двойки.

$1,2,4,8,16,32,\ldots$

$\square$

$$
2^n = (1 + 1)^n = \sum\limits_{k=0}^n C_n^k\cdot 1^k \cdot 1^{n-k} = \sum\limits_{k=0}^n C_n^k = C_n^0 + C_n^1 + C_n^2 + \cdots + C_n^n
$$

Другое доказательство

Рассмотрим все последовательности длины $n$ из $0$ и $1$. Это называется $n$ размещение с повторением из двух элементов.

Всего имеется $2^n$ таких последовательностей.

Для каждого $k$ от $0$ до $n$ число последовательностей с $k$ единицами и $n-k$ нулями равно $C_n^k$.